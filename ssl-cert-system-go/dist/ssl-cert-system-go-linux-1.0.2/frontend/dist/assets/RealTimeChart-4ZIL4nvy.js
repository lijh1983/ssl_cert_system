import{d as W,a as m,p as T,o as q,V as G,b as n,h as o,e,x as y,c as l,f as u,w as c,l as h,k as H,R as J,F as x,t as k,W as K,A as Q}from"./index-BA-staGq.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"real-time-chart"},Z={class:"chart-header"},tt={class:"chart-controls"},et={key:0,class:"chart-loading"},at={key:1,class:"chart-error"},nt={key:2,class:"chart-empty"},ot={key:3,class:"chart-content"},st={class:"mock-chart"},lt={class:"chart-legend"},rt={class:"legend-name"},it={class:"legend-value"},ct={class:"chart-area"},dt={width:"100%",height:"200",viewBox:"0 0 800 200"},ut=["points","stroke"],ft=["cx","cy","fill"],_t={class:"chart-timeline"},mt=W({__name:"RealTimeChart",props:{title:{},type:{},autoRefresh:{type:Boolean,default:!0},refreshInterval:{default:3e4}},emits:["dataUpdate"],setup(B,{emit:U}){const w=B,D=U,C=m(!1),p=m(""),v=m([]),V=m("1h"),S=m();let _=null;const R=T(()=>{switch(w.type){case"cpu":return[{name:"CPU使用率",color:"#1890ff",data:d(),currentValue:"35%"}];case"memory":return[{name:"内存使用率",color:"#52c41a",data:d(),currentValue:"68%"}];case"disk":return[{name:"磁盘使用率",color:"#faad14",data:d(),currentValue:"42%"}];case"network":return[{name:"入站流量",color:"#1890ff",data:d(),currentValue:"125 MB/s"},{name:"出站流量",color:"#52c41a",data:d(),currentValue:"89 MB/s"}];case"certificates":return[{name:"证书健康度",color:"#52c41a",data:d(),currentValue:"98%"}];default:return[]}}),N=T(()=>{const r=new Date,t=[],s=20;for(let i=s-1;i>=0;i--){const f=new Date(r.getTime()-i*5*60*1e3);t.push(f.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}))}return t}),d=()=>{const t=[];let s=Math.random()*50+25;for(let i=0;i<20;i++)s+=(Math.random()-.5)*10,s=Math.max(0,Math.min(100,s)),t.push(Math.round(s));return t},I=r=>r.map((t,s)=>{const i=s/(r.length-1)*800,f=200-t/100*200;return`${i},${f}`}).join(" "),g=async()=>{C.value=!0,p.value="";try{await new Promise(r=>setTimeout(r,500)),v.value=d(),D("dataUpdate",v.value)}catch(r){p.value=r.message||"数据加载失败"}finally{C.value=!1}},z=()=>{g()},L=()=>{g()},A=()=>{w.autoRefresh&&!_&&(_=setInterval(()=>{g()},w.refreshInterval))},P=()=>{_&&(clearInterval(_),_=null)};return q(()=>{g(),A()}),G(()=>{P()}),(r,t)=>{const s=u("a-select-option"),i=u("a-select"),f=u("a-button"),F=u("a-space"),O=u("a-spin"),$=u("a-result"),j=u("a-empty");return o(),n("div",Y,[e("div",Z,[e("h4",null,y(r.title),1),e("div",tt,[l(F,null,{default:c(()=>[l(i,{value:V.value,"onUpdate:value":t[0]||(t[0]=a=>V.value=a),size:"small",onChange:L},{default:c(()=>[l(s,{value:"1h"},{default:c(()=>t[1]||(t[1]=[h("最近1小时")])),_:1,__:[1]}),l(s,{value:"6h"},{default:c(()=>t[2]||(t[2]=[h("最近6小时")])),_:1,__:[2]}),l(s,{value:"24h"},{default:c(()=>t[3]||(t[3]=[h("最近24小时")])),_:1,__:[3]}),l(s,{value:"7d"},{default:c(()=>t[4]||(t[4]=[h("最近7天")])),_:1,__:[4]})]),_:1},8,["value"]),l(f,{size:"small",onClick:z},{icon:c(()=>[l(H(J))]),_:1})]),_:1})])]),e("div",{class:"chart-container",ref_key:"chartContainer",ref:S},[C.value?(o(),n("div",et,[l(O,{size:"large"})])):p.value?(o(),n("div",at,[l($,{status:"error",title:"数据加载失败","sub-title":p.value},{extra:c(()=>[l(f,{type:"primary",onClick:z},{default:c(()=>t[5]||(t[5]=[h("重试")])),_:1,__:[5]})]),_:1},8,["sub-title"])])):!v.value||v.value.length===0?(o(),n("div",nt,[l(j,{description:"暂无监控数据"})])):(o(),n("div",ot,[e("div",st,[e("div",lt,[(o(!0),n(x,null,k(R.value,a=>(o(),n("div",{key:a.name,class:"legend-item"},[e("span",{class:"legend-color",style:Q({backgroundColor:a.color})},null,4),e("span",rt,y(a.name),1),e("span",it,y(a.currentValue),1)]))),128))]),e("div",ct,[(o(),n("svg",dt,[t[6]||(t[6]=e("defs",null,[e("pattern",{id:"grid",width:"40",height:"20",patternUnits:"userSpaceOnUse"},[e("path",{d:"M 40 0 L 0 0 0 20",fill:"none",stroke:"#f0f0f0","stroke-width":"1"})])],-1)),t[7]||(t[7]=e("rect",{width:"100%",height:"100%",fill:"url(#grid)"},null,-1)),(o(!0),n(x,null,k(R.value,(a,M)=>(o(),n("g",{key:a.name},[e("polyline",{points:I(a.data),fill:"none",stroke:a.color,"stroke-width":"2"},null,8,ut),(o(!0),n(x,null,k(a.data,(E,b)=>(o(),n("circle",{key:b,cx:b/(a.data.length-1)*800,cy:200-E/100*200,r:"3",fill:a.color},null,8,ft))),128))]))),128)),t[8]||(t[8]=K('<g class="y-axis" data-v-59351fda><text x="10" y="20" font-size="12" fill="#666" data-v-59351fda>100%</text><text x="10" y="70" font-size="12" fill="#666" data-v-59351fda>75%</text><text x="10" y="120" font-size="12" fill="#666" data-v-59351fda>50%</text><text x="10" y="170" font-size="12" fill="#666" data-v-59351fda>25%</text><text x="10" y="195" font-size="12" fill="#666" data-v-59351fda>0%</text></g>',1))]))]),e("div",_t,[(o(!0),n(x,null,k(N.value,(a,M)=>(o(),n("div",{class:"timeline-item",key:M},y(a),1))),128))])])]))],512)])}}}),vt=X(mt,[["__scopeId","data-v-59351fda"]]);export{vt as R};
