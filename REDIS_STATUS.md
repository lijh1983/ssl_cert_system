# Redisæ”¯æŒçŠ¶æ€è¯´æ˜

## ğŸš¨ é‡è¦è¯´æ˜

**å½“å‰ç‰ˆæœ¬ (v1.0.2) æœªå®ç°RedisåŠŸèƒ½**

åœ¨æŠ€æœ¯æ ˆè¿ç§»è¿‡ç¨‹ä¸­å‘ç°ï¼Œè™½ç„¶éƒ¨åˆ†æ–‡æ¡£æåˆ°äº†Redisæ”¯æŒï¼Œä½†å®é™…ä»£ç ä¸­å¹¶æœªå®ç°Redisç›¸å…³åŠŸèƒ½ã€‚

## ğŸ“Š å½“å‰çŠ¶æ€

### âŒ æœªå®ç°çš„RedisåŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| **Goä¾èµ–** | âŒ æœªæ·»åŠ  | go.modä¸­æ— Rediså®¢æˆ·ç«¯åº“ |
| **é…ç½®æ”¯æŒ** | âŒ æœªå®ç° | æ— Redisé…ç½®é¡¹å’Œè¿æ¥ä»£ç  |
| **ç¼“å­˜åŠŸèƒ½** | âŒ æœªå®ç° | æ— ä»»ä½•ç¼“å­˜é€»è¾‘ |
| **ä¼šè¯å­˜å‚¨** | âŒ æœªå®ç° | ä½¿ç”¨JWTæ— çŠ¶æ€è®¤è¯ |
| **é˜Ÿåˆ—åŠŸèƒ½** | âŒ æœªå®ç° | æ— å¼‚æ­¥é˜Ÿåˆ—éœ€æ±‚ |

### âœ… å·²ä¿®æ­£çš„é…ç½®

| é…ç½®æ–‡ä»¶ | ä¿®æ­£å†…å®¹ | çŠ¶æ€ |
|---------|---------|------|
| **docker-compose.yml** | ç§»é™¤RedisæœåŠ¡é…ç½® | âœ… å·²ä¿®æ­£ |
| **docker-compose.remote-db.yml** | ç§»é™¤RedisæœåŠ¡é…ç½® | âœ… å·²ä¿®æ­£ |
| **docker-compose.fast.yml** | ç§»é™¤RedisæœåŠ¡é…ç½® | âœ… å·²ä¿®æ­£ |
| **ARCHITECTURE.md** | æ›´æ–°æ¶æ„å›¾å’Œè¯´æ˜ | âœ… å·²ä¿®æ­£ |
| **DEPLOYMENT.md** | ç§»é™¤Redisé…ç½®è¯´æ˜ | âœ… å·²ä¿®æ­£ |
| **DEPLOYMENT_OPTIONS.md** | æ›´æ–°ç»„ä»¶è¯´æ˜ | âœ… å·²ä¿®æ­£ |

## ğŸ¯ å½“å‰ç³»ç»Ÿæ¶æ„

### å®é™…æŠ€æœ¯æ ˆ
```
å‰ç«¯: Vue.js 3.x (é™æ€æ–‡ä»¶)
    â†“
åå‘ä»£ç†: Nginx
    â†“
åç«¯: Go 1.21+ (Ginæ¡†æ¶)
    â†“
æ•°æ®åº“: MySQL 8.0+
    â†“
å­˜å‚¨: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ (è¯ä¹¦æ–‡ä»¶)
```

### æ•°æ®å­˜å‚¨æ–¹æ¡ˆ
- **ç”¨æˆ·æ•°æ®**: MySQLæ•°æ®åº“
- **è¯ä¹¦æ•°æ®**: MySQLæ•°æ®åº“ + æœ¬åœ°æ–‡ä»¶
- **é…ç½®æ•°æ®**: ç¯å¢ƒå˜é‡ + é…ç½®æ–‡ä»¶
- **æ—¥å¿—æ•°æ®**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- **ç¼“å­˜**: æ—  (ç›´æ¥æ•°æ®åº“æŸ¥è¯¢)

## ğŸ”® æœªæ¥Redisé›†æˆè®¡åˆ’

### å¯èƒ½çš„ä½¿ç”¨åœºæ™¯

#### 1. ç¼“å­˜åŠŸèƒ½
```go
// ç¤ºä¾‹: è¯ä¹¦çŠ¶æ€ç¼“å­˜
func GetCertificateStatus(domain string) (*CertStatus, error) {
    // 1. å…ˆæŸ¥Redisç¼“å­˜
    if cached := redis.Get("cert:" + domain); cached != nil {
        return cached, nil
    }
    
    // 2. æŸ¥è¯¢æ•°æ®åº“
    status := db.GetCertStatus(domain)
    
    // 3. å†™å…¥ç¼“å­˜ (TTL: 5åˆ†é’Ÿ)
    redis.Set("cert:" + domain, status, 5*time.Minute)
    
    return status, nil
}
```

#### 2. ä¼šè¯å­˜å‚¨
```go
// ç¤ºä¾‹: ç”¨æˆ·ä¼šè¯ç¼“å­˜
func StoreUserSession(userID int, sessionData *Session) error {
    key := fmt.Sprintf("session:%d", userID)
    return redis.Set(key, sessionData, 24*time.Hour)
}
```

#### 3. ä»»åŠ¡é˜Ÿåˆ—
```go
// ç¤ºä¾‹: è¯ä¹¦ç»­æœŸé˜Ÿåˆ—
func QueueCertificateRenewal(domain string) error {
    task := RenewalTask{Domain: domain, Priority: "normal"}
    return redis.LPush("renewal_queue", task)
}
```

### é›†æˆæ­¥éª¤ (æœªæ¥ç‰ˆæœ¬)

#### 1. æ·»åŠ ä¾èµ–
```bash
go get github.com/go-redis/redis/v8
```

#### 2. é…ç½®æ”¯æŒ
```go
type Config struct {
    Redis struct {
        Host     string `env:"REDIS_HOST" default:"localhost"`
        Port     int    `env:"REDIS_PORT" default:"6379"`
        Password string `env:"REDIS_PASSWORD"`
        DB       int    `env:"REDIS_DB" default:"0"`
    }
}
```

#### 3. è¿æ¥ç®¡ç†
```go
func NewRedisClient(cfg *Config) *redis.Client {
    return redis.NewClient(&redis.Options{
        Addr:     fmt.Sprintf("%s:%d", cfg.Redis.Host, cfg.Redis.Port),
        Password: cfg.Redis.Password,
        DB:       cfg.Redis.DB,
    })
}
```

## ğŸš€ å½“å‰ç³»ç»Ÿä¼˜åŠ¿

### æ— Redisçš„ä¼˜ç‚¹
1. **éƒ¨ç½²ç®€å•**: å‡å°‘ç»„ä»¶ä¾èµ–
2. **ç»´æŠ¤ç®€å•**: æ— éœ€ç®¡ç†Rediså®ä¾‹
3. **èµ„æºèŠ‚çœ**: å‡å°‘å†…å­˜å’Œç½‘ç»œå¼€é”€
4. **ä¸€è‡´æ€§**: ç›´æ¥æ•°æ®åº“æŸ¥è¯¢ï¼Œæ•°æ®ä¸€è‡´æ€§å¥½

### æ€§èƒ½è¡¨ç°
- **å“åº”æ—¶é—´**: 7ms (å·²ç»éå¸¸ä¼˜ç§€)
- **å†…å­˜ä½¿ç”¨**: <50MB (Goè¯­è¨€é«˜æ•ˆ)
- **å¹¶å‘å¤„ç†**: GoroutineåŸç”Ÿæ”¯æŒ
- **æ•°æ®åº“**: GORMè¿æ¥æ± ä¼˜åŒ–

## ğŸ“‹ å»ºè®®

### å½“å‰ç‰ˆæœ¬ (v1.0.2)
- âœ… **ç»§ç»­ä½¿ç”¨**: å½“å‰æ¶æ„å·²ç»è¶³å¤Ÿé«˜æ•ˆ
- âœ… **ä¸“æ³¨ä¼˜åŒ–**: ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢å’ŒGoä»£ç æ€§èƒ½
- âœ… **ç›‘æ§æ€§èƒ½**: è§‚å¯Ÿå®é™…ä½¿ç”¨ä¸­çš„æ€§èƒ½ç“¶é¢ˆ

### æœªæ¥ç‰ˆæœ¬è€ƒè™‘
- ğŸ”® **ç”¨æˆ·é‡å¢é•¿**: å½“å¹¶å‘ç”¨æˆ· >1000 æ—¶è€ƒè™‘Redis
- ğŸ”® **å“åº”æ—¶é—´**: å½“å¹³å‡å“åº”æ—¶é—´ >100ms æ—¶è€ƒè™‘ç¼“å­˜
- ğŸ”® **åŠŸèƒ½éœ€æ±‚**: å½“éœ€è¦å®æ—¶é€šçŸ¥ã€ä»»åŠ¡é˜Ÿåˆ—æ—¶è€ƒè™‘Redis

## ğŸ¯ ç»“è®º

**å½“å‰ç³»ç»Ÿæ— éœ€Rediså³å¯æ»¡è¶³å¤§éƒ¨åˆ†ä½¿ç”¨åœºæ™¯**

- SSLè¯ä¹¦ç®¡ç†ç³»ç»Ÿçš„æ•°æ®è®¿é—®æ¨¡å¼ç›¸å¯¹ç®€å•
- Goè¯­è¨€çš„é«˜æ€§èƒ½å·²ç»æä¾›äº†ä¼˜ç§€çš„å“åº”æ—¶é—´
- MySQLæ•°æ®åº“è¶³ä»¥å¤„ç†è¯ä¹¦ç®¡ç†çš„æ•°æ®éœ€æ±‚
- ç®€åŒ–çš„æ¶æ„æ›´æ˜“äºéƒ¨ç½²å’Œç»´æŠ¤

**Redisé›†æˆå°†åœ¨æœ‰æ˜ç¡®æ€§èƒ½éœ€æ±‚æ—¶è€ƒè™‘æ·»åŠ åˆ°åç»­ç‰ˆæœ¬ä¸­ã€‚**
